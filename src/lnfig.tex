\section{Figures of Lightning transactions}
  \label{sec:tx-figures}
  We here provide a pictorial representation of the special transactions that
  comprise an open channel. In this example, \alice{} and \bob{} have a channel
  where \alice{} owns $c_A$ coins, \bob{} owns $c_B$ coins and there is an
  outstanding HTLC of value $c_h$ offered by \alice{} to \bob. As such, if
  \bob{} learns the necessary preimage until block height
  ``$\mathrm{height}_{\mathrm{cltv}}$'', he can get the $c_h$ coins by
  cooperatively updating the channel to a state (i.e. a new pair of commitment
  transactions) where there is no HTLC output and the value of his output is
  $c_h + c_B$, or, in case \alice{} is uncooperative, by publishing
  $\mathrm{comm}_B$ and $\mathrm{HTLC}_B$. The latter transaction is valid only
  if it contains the preimage of the hash $h$, which in turn is hardcoded in the
  two commitment transactions. Correspndingly, \alice{} can get the $c_h$ coins
  only if after block height ``$\mathrm{height}_{\mathrm{cltv}}$'' they remain
  unclaimed by \bob. She can obtain them either by cooperatively updating the
  channel, or unilaterally by publishing $\mathrm{comm}_A$ and
  $\mathrm{HTLC}_A$.

  \begin{figure}[H]
  \centering
  \begin{pspicture}
    \drawtx{funding}{
      {{},{}}%
    }{
      {{$pk_{F{,} A} \wedge pk_{F{,} B}$},{$c_A + c_B + c_h$}}%
    }
  \end{pspicture}
  \label{fig:ln:funding}
  \caption{Funding TX (on-chain)}
  \end{figure}

  \begin{figure}[H]
  \centering
  \begin{pspicture}
    \drawtx{$\mathrm{comm}_A$}{
      {{$\sigma_{F{,} A} \wedge \sigma_{F{,} B}$},{funding}}%
    }{
      {{$pk_{\mathrm{rev}{,} B} \vee$,
      $(\mathrm{relDel}_B \wedge pk_{\mathrm{dcom}{,} A})$},{$c_A$}},
      {{$pk_{\mathrm{rev}{,} B} \vee (pk_{\mathrm{htlc}{,} B} \wedge h)$,
      $\vee (pk_{htlc{,} A} \wedge pk_{htlc{,} B})$},{$c_h$}},
      {{$pk_{\mathrm{com}{,} B}$},{$c_B$}}%
    }
  \end{pspicture}
  \label{fig:ln:commitment:alice}
  \caption{\alice's commitment TX (off-chain)}
  \end{figure}

  \begin{figure}[H]
  \centering
  \begin{pspicture}
    \drawtx{$\mathrm{comm}_B$}{
      {{$\sigma_{F{,} A} \wedge \sigma_{F{,} B}$},{funding}}%
    }{
      {{$pk_{\mathrm{rev}{,} A} \vee$,
      $(\mathrm{relDel}_A \wedge pk_{\mathrm{dcom}{,} B})$},{$c_B$}},
      {{$pk_{\mathrm{rev}{,} A} \vee$,
      $(pk_{\mathrm{htlc}{,} A} \wedge pk_{\mathrm{htlc}{,} B} \wedge h)$,
      $\vee (\mathrm{height}_{\mathrm{cltv}}
      \wedge pk_{\mathrm{htlc}{,} A})$},{$c_h$}},
      {{$pk_{\mathrm{com}{,} A}$},{$c_A$}}%
    }
  \end{pspicture}
  \label{fig:ln:commitment:bob}
  \caption{\bob's commitment TX (off-chain)}
  \end{figure}

  \begin{figure}[H]
  \centering
  \begin{pspicture}
    \drawtx{$\mathrm{HTLC}_A$}{
      {{$\sigma_{\mathrm{htlc}{,} A} \wedge \sigma_{\mathrm{htlc}{,} B}$},
      {$\mathrm{comm}_A[2]$}}%
    }{
      {{$pk_{\mathrm{rev}{,} B} \vee$,
      $(\mathrm{relDel}_B \wedge pk_{\mathrm{dcom}{,} A})$},
      {$c_h$}}%
    }
  \end{pspicture}
  \label{fig:ln:htlc:alice}
  \caption{\alice's HTLC-Timeout TX (off-chain)}
  \end{figure}

  \begin{figure}[H]
  \centering
  \begin{pspicture}
    \drawtx{$\mathrm{HTLC}_B$}{
      {{$\sigma_{\mathrm{htlc}{,} A} \wedge \sigma_{\mathrm{htlc}{,} B}$,
      $\wedge \mathrm{Preim}(h)$},{$\mathrm{comm}_B[2]$}}%
    }{
      {{$pk_{\mathrm{rev}{,} A} \vee$,
      $(\mathrm{relDel}_A \wedge pk_{\mathrm{dcom}{,} B})$},
      {$c_h$}}%
    }
  \end{pspicture}
  \label{fig:ln:htlc:bob}
  \caption{\bob's HTLC-Success TX (off-chain)}
  \end{figure}
