\section{A ledger with instant finality is unrealisable}
\label{sec:perfect-ledger}
  As already mentioned, previous attempts at formalising payment channels in
  UC~\cite{DBLP:conf/ccs/DziembowskiFH18,perun,Malavolta:2017:CPP:3133956.3134096,sprites}
  assume a variant of a ledger functionality with instant finality. We here
  define a reasonable variant \perfectledger{}
  (Fig.~\ref{fig:perfectledger:func}) where all submitted transactions are
  instantly added to the ledger and immediately available to be read by all
  players. Subsequently we argue that, albeit an attractive abstraction, such a
  functionality is unrealisable, even under strong network assumptions, i.e. a
  multicast synchronous network $\FnetworkEd^1$.

  Such a network ensures that messages sent by honest parties will be instantly
  delivered to all other parties; no delays can be introduced by the adversary.
  The latter however may choose to send its own messages only to specific
  parties. This allows the adversary to spread conflicting information or
  withhold data from some parties. As we will see, this adversarial ability
  precludes the possibility of the ledger of Fig.~\ref{fig:perfectledger:func}
  to be realised. We refer the reader to Appendix~\ref{appendix:ledger} for the
  formal definition of $\FnetworkEd^1$.

  \begin{figure}[H]
    \begin{systembox}{\perfectledger}
      \begin{algorithmic}[1]
        \State State: List of txs $\mathcal{L}$
        \Statex

        \State Upon receiving (\textsc{Submit}, $m$) from \alice or \adversary,
        append $m$ to $\mathcal{L}$ and send (\textsc{Submit}, \alice or
        \adversary, $m$) to \adversary
        \Statex

        \State Upon receiving (\textsc{Read}) from \alice, send (\textsc{Read},
        $\mathcal{L}$) to \alice
      \end{algorithmic}
    \end{systembox}
    \caption{}
    \label{fig:perfectledger:func}
  \end{figure}

  \begin{theorem}[Perfect Ledger is Unrealisable]
    \label{theorem:perfectledger}
    For any ITM \perfectprot{} there exist ITMs \perfectenv,
    \perfectadv{} such that for any ITM \simulator
    \begin{equation*}
      \textsc{Exec}^{\FnetworkEd^1, \gFclock}_{\perfectprot, \adversary,
      \environment} \not\approx \textsc{Exec}^{\perfectledger,
      \gFclock}_{\simulator, \environment}
    \end{equation*}
  \end{theorem}

  \begin{proofsketch}
    We take advantage of the \adversary's ability to selectively send messages
    to specific players. In particular, \environment{} starts an execution with
    2 players and generates a random message $m$. In half of the executions
    (randomly selected), $m$ is multicast only to one of the two players, say
    \alice{} by \adversary{} (in the real world). The environment then sends
    \textsc{read} to the other player, say \bob. If \bob{} knows $m$, then
    \environment{} assumes that it is the ideal world, otherwise it sends
    \textsc{read} to \alice. If she knows $m$, then \environment{} decides it is
    in the real world, otherwise it declares this the ideal world.

    To avoid the obvious counterattack of a protocol that always returns an
    empty ledger, in the other half of the executions \environment{} sends
    (\textsc{submit}, $m$) to \alice{} and then (\textsc{read}) to \bob. If
    \bob{} knows $m$, then \environment{} decides this is the ideal world, so
    for that case the protocol is forced to try to achieve instant finality.
  \end{proofsketch}
